<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>میم‌کوین‌شناس</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .token-card {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 15px;
      background-color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 15px;
    }
    .risk-low { color: green; }
    .risk-medium { color: orange; }
    .risk-high { color: red; }
    .token-actions {
      margin-top: 10px;
    }
  </style>
</head>
<body class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>📊 لیست میم‌کوین‌های شناسایی‌شده</h2>
    <div>
      <a href="/edit_filters" class="btn btn-outline-secondary me-2">⚙️ ویرایش فیلترها</a>
      <a href="/watchlist" class="btn btn-primary">📋 مشاهده واچ‌لیست</a>
    </div>
  </div>

  <p>آخرین بروزرسانی: {{ last_updated }}</p>

  {% for token in tokens %}
    <div class="token-card">
      <h5>{{ token.name }} ({{ token.symbol }})</h5>
      <p><strong>نقدینگی:</strong> ${{ token.liquidity_usd }} | <strong>تغییر قیمت ۵دقیقه:</strong> {{ token.price_change_5m }}%</p>
      <p><strong>سازنده چند توکن ساخته؟</strong> {{ token.creator_token_count }} | <strong>تو واچ‌لیست چند نفره؟</strong> {{ token.watchlist_count }}</p>
      <p><strong>حجم ۲۴ساعته:</strong> ${{ token.volume_24h }}</p>
      <p><strong>آدرس کانترکت:</strong> {{ token.address }}</p>
      <p><a href="{{ token.chart_url }}" target="_blank">📈 مشاهده نمودار</a></p>

      <p>
        <strong>ریسک:</strong>
        {% if token.risk_level == 'low' %}
          <span class="risk-low">🟢 پایین</span>
        {% elif token.risk_level == 'medium' %}
          <span class="risk-medium">🟠 متوسط</span>
        {% else %}
          <span class="risk-high">🔴 بالا</span>
        {% endif %}
      </p>

      <div class="token-actions">
        {% if token.address in watchlist %}
          <form action="/unwatch" method="POST" style="display:inline;">
            <input type="hidden" name="token_address" value="{{ token.address }}">
            <button type="submit" class="btn btn-sm btn-outline-danger">❌ حذف از واچ‌لیست</button>
          </form>
        {% else %}
          <form action="/watch" method="POST" style="display:inline;">
            <input type="hidden" name="token_address" value="{{ token.address }}">
            <button type="submit" class="btn btn-sm btn-outline-success">➕ افزودن به واچ‌لیست</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% endfor %}

</body>
</html>
