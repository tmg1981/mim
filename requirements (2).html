<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8" />
    <title>میم‌کوین‌شناس - داشبورد</title>
    <style>
        body {font-family: Arial, sans-serif; direction: rtl; padding: 20px;}
        .token {border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 5px;}
        .token h3 {margin: 0;}
        .btn {padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer;}
        .btn-watch {background-color: #4CAF50; color: white;}
        .btn-unwatch {background-color: #f44336; color: white;}
        .nav {margin-bottom: 20px;}
        .nav a {margin-left: 15px; text-decoration: none; font-weight: bold;}
    </style>
</head>
<body>
    <h1>میم‌کوین‌شناس - داشبورد</h1>
    <div class="nav">
        <a href="{{ url_for('watchlist_view') }}">مشاهده واچ‌لیست</a>
        <a href="{{ url_for('edit_filters') }}">تغییر فیلترها</a>
    </div>
    <p>آخرین بروزرسانی: {{ last_update }}</p>
    {% for token in tokens %}
        <div class="token">
            <h3>{{ token.token_name }} ({{ token.token_symbol }})</h3>
            <p>قیمت: {{ token.price_usd }} دلار</p>
            <p>نقدینگی: {{ token.liquidity }}</p>
            <p>مارکت کپ: {{ token.market_cap }}</p>
            <p>تغییر ۵ دقیقه اخیر: {{ token.price_change_5m }}%</p>
            <p>آدرس کانترکت: {{ token.address }}</p>
            <p><a href="https://www.dextools.io/app/en/ether/pair-explorer/{{ token.address }}" target="_blank">مشاهده نمودار</a></p>

            {% if token.address in watchlist_addresses %}
                <form action="{{ url_for('unwatch') }}" method="post" style="display:inline;">
                    <input type="hidden" name="token_address" value="{{ token.address }}">
                    <button class="btn btn-unwatch" type="submit">حذف از واچ‌لیست</button>
                </form>
            {% else %}
                <form action="{{ url_for('watch') }}" method="post" style="display:inline;">
                    <input type="hidden" name="token_address" value="{{ token.address }}">
                    <label>قیمت خرید: <input type="number" name="buy_price" step="0.00001" required></label>
                    <label>مقدار: <input type="number" name="amount" step="0.01" required></label>
                    <button class="btn btn-watch" type="submit">افزودن به واچ‌لیست</button>
                </form>
            {% endif %}
        </div>
    {% endfor %}
</body>
</html>
